window.__require=function e(t,i,a){function n(s,o){if(!i[s]){if(!t[s]){var r=s.split("/");if(r=r[r.length-1],!t[r]){var l="function"==typeof __require&&__require;if(!o&&l)return l(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var d=i[s]={exports:{}};t[s][0].call(d.exports,function(e){return n(t[s][1][e]||e)},d,d.exports,e,t,i,a)}return i[s].exports}for(var c="function"==typeof __require&&__require,s=0;s<a.length;s++)n(a[s]);return n}({CommingObject:[function(e,t,i){"use strict";cc._RF.push(t,"4621awNQHBKMpz1LXOuN7vT","CommingObject");var a=e("StageManager");cc.Class({extends:cc.Component,properties:{_stageManager:null,moveSpeed:500,plusScore:0,plusSpecial:0,collisionAudio:{default:null,type:cc.AudioClip}},onLoad:function(){var e=cc.find("StageManager");this._stageManager=e.getComponent(a)},update:function(e){if(this._stageManager._state===a.State.RUNNING){var t=(this.moveSpeed+this._stageManager._addSpeed)*e;this.node.x<-.5*cc.winSize.width-this.node.width?this.node.destroy():this.node.x-=t}}}),cc._RF.pop()},{StageManager:"StageManager"}],Player:[function(e,t,i){"use strict";cc._RF.push(t,"d102eJip1hNvoNSqHkjxXhK","Player");var a=e("StageManager");cc.Class({extends:cc.Component,properties:{jumpAudio:{default:null,type:cc.AudioClip},attackAudio:{default:null,type:cc.AudioClip},stageManager:{default:null,type:a},jumpDurationTime:.6,jumpHeight:200,_isJumping:!1,_dead:!1},onLoad:function(){this.setTouchEvent()},onEnable:function(){cc.director.getCollisionManager().enabled=!0},setTouchEvent:function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(t){e.jumpPlayer()},this)},jumpPlayer:function(){if(!this._isJumping){var e=this.node.getComponent(cc.Animation);e.play("PlayerJump"),this._isJumping=!0;var t=this;cc.callFunc(function(){t._isJumping=!1,e.play("PlayerRun")},this);cc.tween(this.node).by(.3,{position:{value:cc.v3(0,200,0),easing:"sineOut"}}).by(.3,{position:{value:cc.v3(0,-200,0),easing:"sineIn"}}).call(function(){t._isJumping=!1,e.play("PlayerRun")}).start(),cc.audioEngine.play(this.jumpAudio)}},onCollisionEnter:function(e,t){var i=e.node.getComponent("CommingObject");switch(e.tag){case 1:if(this.stageManager._isInvincible)return cc.audioEngine.play(this.attackAudio),this.stageManager.plusScore(i.plusScore),e.getComponent(cc.BoxCollider).enabled=!1,void cc.tween(e.node).by(.2,{position:cc.v2(1200,500*(Math.random()-.5))}).call(function(){return e.node.destroy()}).start();this.dead(),cc.audioEngine.play(i.collisionAudio);break;case 2:cc.audioEngine.play(i.collisionAudio),this.stageManager.plusScore(i.plusScore),this.stageManager.plusSpecial(i.plusSpecial),e.node.destroy()}},dead:function(){this._dead||(this._dead=!0,this.node.stopAllActions(),this.enableTouch(!1),cc.tween(this.node).by(.2,{position:{value:cc.v3(-50,100,0),easing:"sineOut"}}).by(.6,{position:{value:cc.v3(-150,-900,0),easing:"sineIn"}}).start(),this.stageManager.execGameOver())},enableTouch:function(e){e?this.setTouchEvent():this.node.targetOff(cc.Node.EventType.TOUCH_START)}}),cc._RF.pop()},{StageManager:"StageManager"}],ScleenScroll:[function(e,t,i){"use strict";cc._RF.push(t,"c405axv3zZFv6FRfxoLYy7g","ScleenScroll");var a=e("StageManager");cc.Class({extends:cc.Component,properties:{_stageManager:null,otherSprite:{default:null,type:cc.Sprite},moveSpeed:500},onLoad:function(){var e=cc.find("StageManager");this._stageManager=e.getComponent(a)},update:function(e){if(this._stageManager._state===a.State.RUNNING){var t=(this.moveSpeed+this._stageManager._addSpeed)*e;this.node.x<=-this.node.width?this.node.x=this.otherSprite.node.x+this.otherSprite.node.width-t:this.node.x-=t}}}),cc._RF.pop()},{StageManager:"StageManager"}],ScrollManager:[function(e,t,i){"use strict";cc._RF.push(t,"f42deJQ6r1DuJARNLmbhQp9","ScrollManager"),cc.Class({extends:cc.Component}),cc._RF.pop()},{}],StageManager:[function(e,t,i){"use strict";cc._RF.push(t,"202c5EueSZPuaq6NHckst0v","StageManager");var a=cc.Enum({READY:0,WAITING_WAVE:1,RUNNING:2,GAMEOVER:9});cc.Class({extends:cc.Component,properties:{blockDistance:400,blockMax:10,waveAccSpeed:20,waveMax:15,_wave:1,_addSpeed:0,_addDistance:0,_score:0,_special:0,_isInvincible:!1,stageBGM:{default:null,type:cc.AudioClip},invincibleBGM:{default:null,type:cc.AudioClip},_bgmId:-1,gameOverLayout:{default:null,type:cc.Node},_state:a.READY,cakePrefab:{default:null,type:cc.Prefab},blockPrefab:{default:null,type:cc.Prefab},scoreLabel:{default:null,type:cc.Label},waveLabel:{default:null,type:cc.Label},specialGauge:{default:null,type:cc.ProgressBar}},statics:{State:a},onLoad:function(){this.createWave(400+this.blockDistance+this._addDistance),this._state=a.RUNNING,this._bgmId=cc.audioEngine.play(this.stageBGM,!0)},update:function(e){this._state===a.RUNNING&&(this.plusScore(100*e),this.renewLabel(),this.checkWave(),this._isInvincible&&(this._special-=(20+.01*this._addSpeed)*e,this.specialGauge.progress=this._special/100,this._special<=0&&(this._special=0,cc.audioEngine.stop(this._bgmId),this._bgmId=cc.audioEngine.play(this.stageBGM,!0),this._isInvincible=!1,this.specialGauge.getComponent(cc.ProgressBar).barSprite.node.color=cc.Color.WHITE)))},checkInvicible:function(){this._special-=(20+.01*this._addSpeed)*dt,this._special<=0&&(this._special=0,cc.audioEngine.stop(this._bgmId),this._bgmId=cc.audioEngine.play(this.stageBGM,!0),this._isInvincible=!1,this.specialGauge.getComponent(cc.ProgressBar).barSprite.node.color=cc.Color.WHITE),this.specialGauge.progress=this.special/100},createWave:function(e){for(var t=cc.find("Canvas/Blocks"),i=cc.find("Canvas/BackGroundManager/GroundA"),a=i.getPosition().y+.5*i.height,n=cc.find("Canvas/Player").getComponent("Player"),c=0;c<this.blockMax;c++){var s=cc.instantiate(this.blockPrefab);t.addChild(s);var o=this.blockDistance+this._addDistance,r=Math.random()<.5?0:n.jumpHeight-20;s.setPosition(cc.Vec2(e+o*(c+1),a+.5*s.height+r));var l=cc.instantiate(this.cakePrefab);t.addChild(l);var d=Math.random()<.5?0:n.jumpHeight-20;l.setPosition(cc.Vec2(e+o*(c+1)-.5*o,a+.5*s.height+d))}},checkWave:function(){0===cc.find("Canvas/Blocks").getChildrenCount()&&(this._wave++,this._wave<=this.waveMax&&(this._addSpeed+=.5*this._wave*this.waveAccSpeed,this._addDistance+=.5*this._wave*(.5*this.waveAccSpeed)),this.createWave(400+this.blockDistance+this._addDistance))},execGameOver:function(){cc.director.getCollisionManager().enebled=!1,this._state=a.GAMEOVER,this.gameOverLayout.active=!0,cc.audioEngine.stop(this._bgmId),this._bgmId=-1},restorStage:function(){cc.director.loadScene("Game")},plusScore:function(e){this._score+=e},plusSpecial:function(e){if(this._special+=e,this._special>=100&&(this._special=100),this.specialGauge.progress=this._special/100,this._special>=100&&!this._isInvincible){var t=new cc.Color(240,146,228);this.specialGauge.getComponent(cc.ProgressBar).barSprite.node.color=t,cc.audioEngine.stop(this._bgmId),this._bgmId=cc.audioEngine.play(this.invincibleBGM,!0),this._isInvincible=!0}},renewLabel:function(){this.waveLabel.string="wave : "+this._wave,this.scoreLabel.string="score : "+Math.floor(this._score)}}),cc._RF.pop()},{}]},{},["CommingObject","ScleenScroll","ScrollManager","StageManager","Player"]);